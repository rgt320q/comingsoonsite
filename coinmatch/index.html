<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Para Maçı</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAdgAAAHYBTnsmCAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAERSURBVDiNpdMxSsNQGMDx/5e8NBGhIA6Cix0EwcFJnNzFxV28gYt4Aw/gKbyCx/AIHkJwcRAHBUVEHBRB0KF5eRoHk5pXTdIP3vJ9vx++5X0fKaWsZR1rrWVd6zo45xhjePz6ZrFYkFLi7uEJ5xyICMYYlFI8PT+TUsL5ICZC/CfGGJRS9HqD1YBSipQSIsL0dJLFYsnl5RWTyTHD4SGj0RGiQkqJ+Xw+/JnNZgRwezfNYrFifn7BcLhPt9tjeHKAqBBCYH5+TgghG/B6FQC4u58mxsjl5ZU8HA5QVUREhBCIMS4D1tr3CACUUrTbbarqnbquqaoKYwxKqT8BAKqqegdACIFWq0VRVVRVRV3XVFWFMaYxAPANe+Fl1fSJH1kAAAAASUVORK5CYII=">
    <script>
        // Suppress Tailwind CDN production warning before loading
        (function() {
            const originalWarn = console.warn;
            console.warn = function(...args) {
                // Filter out Tailwind CDN production warning
                if (args[0] && typeof args[0] === 'string' && args[0].includes('cdn.tailwindcss.com should not be used in production')) {
                    return;
                }
                originalWarn.apply(console, args);
            };
        })();
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Restore console.warn after Tailwind loads
        setTimeout(() => {
            // Config is still needed for other purposes
            tailwind.config = {
                devtools: false
            };
        }, 100);
    </script>
    <link href="./css/style.css?v=1" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .text-shadow { text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .hidden { display: none; }
        .spinner { border-top-color: transparent; }
        body.scrolling-disabled { overflow: hidden; touch-action: none; }
        canvas { touch-action: none; }
        
        /* Game Over Screen Animations */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse-glow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(34, 197, 94, 0.5);
            }
            50% {
                box-shadow: 0 0 40px rgba(34, 197, 94, 0.8);
            }
        }
        
        #game-overlay > div {
            animation: slideInUp 0.5s ease-out;
        }
        
        #rematch-button:not(.hidden):not(:disabled) {
            animation: pulse-glow 2s ease-in-out infinite;
        }
        
        #rematch-button:disabled {
            cursor: not-allowed !important;
            opacity: 0.9;
        }
        
        @keyframes checkmark-pop {
            0% {
                transform: scale(0);
            }
            50% {
                transform: scale(1.2);
            }
            100% {
                transform: scale(1);
            }
        }
        
        #rematch-button:disabled svg {
            animation: checkmark-pop 0.5s ease-out;
        }
        
        #rematch-status-container > div {
            animation: slideInUp 0.3s ease-out backwards;
        }
        
        #rematch-status-container > div:nth-child(1) { animation-delay: 0.1s; }
        #rematch-status-container > div:nth-child(2) { animation-delay: 0.2s; }
        #rematch-status-container > div:nth-child(3) { animation-delay: 0.3s; }
        #rematch-status-container > div:nth-child(4) { animation-delay: 0.4s; }
    </style>
</head>
<body class="bg-slate-800 text-white flex items-center justify-center min-h-screen p-4">

    <!-- Auth Screen -->
    <div id="auth-screen" class="w-full max-w-md mx-auto bg-slate-900/70 p-6 rounded-lg shadow-2xl hidden">
        <h2 class="text-3xl font-bold text-center mb-6 text-amber-300 text-shadow">Para Maçı</h2>
        <!-- Login Form -->
        <form id="login-form" class="space-y-4">
            <div>
                <label for="login-email" class="block mb-1 font-semibold text-slate-300">Email</label>
                <input type="email" id="login-email" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" required>
            </div>
            <div>
                <label for="login-password" class="block mb-1 font-semibold text-slate-300">Şifre</label>
                <input type="password" id="login-password" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" required>
            </div>
            <div id="login-error" class="text-red-400 text-sm hidden p-3 rounded bg-red-900/30 border border-red-800/50 flex items-start space-x-2">
                <span class="text-lg">⚠️</span>
                <span class="flex-1"></span>
            </div>
            <button type="submit" class="w-full bg-amber-500 hover:bg-amber-600 text-slate-900 font-bold py-3 rounded-lg shadow-lg transition-transform transform hover:scale-105 flex items-center justify-center relative">
                <span class="button-text">Giriş Yap</span>
                <div class="spinner w-5 h-5 border-4 border-slate-900 rounded-full animate-spin hidden absolute"></div>
            </button>
            <p class="text-center text-sm text-slate-400">Hesabın yok mu? <a href="#" id="show-register" class="text-amber-400 hover:underline">Kayıt Ol</a></p>
        </form>
        <!-- Register Form -->
        <form id="register-form" class="space-y-4 hidden">
            <div>
                <label for="register-email" class="block mb-1 font-semibold text-slate-300">Email</label>
                <input type="email" id="register-email" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" required>
            </div>
            <div>
                <label for="register-password" class="block mb-1 font-semibold text-slate-300">Şifre</label>
                <input type="password" id="register-password" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" required>
                
                <!-- Password Requirements -->
                <div id="password-requirements" class="mt-2 p-3 bg-slate-800/50 rounded-lg border border-slate-700 space-y-1 text-sm hidden">
                    <div class="font-semibold text-slate-300 mb-2">Şifre gereksinimleri:</div>
                    <div id="req-length" class="flex items-center gap-2 text-slate-400">
                        <span class="requirement-icon">○</span>
                        <span>En az 6 karakter</span>
                    </div>
                    <div id="req-uppercase" class="flex items-center gap-2 text-slate-400">
                        <span class="requirement-icon">○</span>
                        <span>En az bir büyük harf (A-Z)</span>
                    </div>
                    <div id="req-lowercase" class="flex items-center gap-2 text-slate-400">
                        <span class="requirement-icon">○</span>
                        <span>En az bir küçük harf (a-z)</span>
                    </div>
                    <div id="req-number" class="flex items-center gap-2 text-slate-400">
                        <span class="requirement-icon">○</span>
                        <span>En az bir rakam (0-9)</span>
                    </div>
                </div>
            </div>
            <div>
                <label for="register-password-confirm" class="block mb-1 font-semibold text-slate-300">Şifre Tekrar</label>
                <input type="password" id="register-password-confirm" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" required>
            </div>
            <div id="register-error" class="text-red-400 text-sm hidden p-3 rounded bg-red-900/30 border border-red-800/50 flex items-start space-x-2">
                <span class="text-lg">⚠️</span>
                <span class="flex-1"></span>
            </div>
            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-lg transition-transform transform hover:scale-105 flex items-center justify-center relative">
                <span class="button-text">Kayıt Ol</span>
                <div class="spinner w-5 h-5 border-4 border-white rounded-full animate-spin hidden absolute"></div>
            </button>
            <p class="text-center text-sm text-slate-400">Zaten hesabın var mı? <a href="#" id="show-login" class="text-amber-400 hover:underline">Giriş Yap</a></p>
        </form>
    </div>

    <!-- User Profile Screen -->
    <div id="profile-screen" class="w-full max-w-md mx-auto bg-slate-900/70 p-6 rounded-lg shadow-2xl hidden overflow-y-auto max-h-screen">
        <h2 class="text-2xl font-bold text-center mb-6 text-amber-300">Kullanıcı Profili</h2>
        <form id="profile-form" class="space-y-4">
            <div>
                <label for="profile-firstname" class="block mb-1 font-semibold text-slate-300">Ad</label>
                <input type="text" id="profile-firstname" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Adınız">
            </div>
            <div>
                <label for="profile-lastname" class="block mb-1 font-semibold text-slate-300">Soyad</label>
                <input type="text" id="profile-lastname" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Soyadınız">
            </div>
            <div>
                <label for="profile-nickname" class="block mb-1 font-semibold text-slate-300">Takma Ad</label>
                <input type="text" id="profile-nickname" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Oyundaki takma adınız">
            </div>
            <div>
                <label for="profile-phone" class="block mb-1 font-semibold text-slate-300">Telefon</label>
                <input type="tel" id="profile-phone" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="+90 5xx xxx xx xx">
            </div>
            <div>
                <label for="profile-email-display" class="block mb-1 font-semibold text-slate-300">Email</label>
                <input type="email" id="profile-email-display" class="w-full p-2 rounded bg-slate-600 text-slate-400 border border-slate-600" disabled>
            </div>
            
            <div class="border-t border-slate-600 pt-4 mt-4">
                <h3 class="text-lg font-semibold text-slate-300 mb-3">Şifre Değiştir</h3>
                <div class="space-y-3">
                    <div>
                        <label for="current-password" class="block mb-1 text-sm text-slate-400">Mevcut Şifre</label>
                        <input type="password" id="current-password" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Mevcut şifreniz">
                    </div>
                    <div>
                        <label for="new-password" class="block mb-1 text-sm text-slate-400">Yeni Şifre</label>
                        <input type="password" id="new-password" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Yeni şifreniz">
                    </div>
                    <div>
                        <label for="new-password-confirm" class="block mb-1 text-sm text-slate-400">Yeni Şifre Tekrar</label>
                        <input type="password" id="new-password-confirm" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Yeni şifrenizi tekrar girin">
                    </div>
                    <p class="text-xs text-slate-400">Not: Şifre değiştirmek istemiyorsanız bu alanları boş bırakabilirsiniz.</p>
                </div>
            </div>
            
            <div class="border-t border-slate-600 pt-4 mt-4">
                <h3 class="text-lg font-semibold text-slate-300 mb-3">Görüntüleme Tercihi</h3>
                <div class="space-y-2">
                    <label class="flex items-center space-x-3 cursor-pointer">
                        <input type="radio" name="display-preference" value="realname" id="display-realname" class="w-4 h-4 text-amber-500">
                        <span class="text-slate-300">Gerçek Adımı Göster (Ad Soyad)</span>
                    </label>
                    <label class="flex items-center space-x-3 cursor-pointer">
                        <input type="radio" name="display-preference" value="nickname" id="display-nickname" class="w-4 h-4 text-amber-500" checked>
                        <span class="text-slate-300">Takma Adımı Göster</span>
                    </label>
                </div>
            </div>

            <div class="border-t border-slate-600 pt-4 mt-4">
                <h3 class="text-lg font-semibold text-slate-300 mb-3">📊 Oyun İstatistikleri</h3>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                    <div class="bg-slate-800/60 p-3 rounded text-center">
                        <div class="text-slate-400 text-xs mb-1">Toplam Puan</div>
                        <div id="stat-total-points" class="font-bold text-amber-300 text-2xl">0</div>
                    </div>
                    <div class="bg-slate-800/60 p-3 rounded text-center">
                        <div class="text-slate-400 text-xs mb-1">Toplam Oyun Süresi</div>
                        <div id="stat-total-game-time" class="font-bold text-white">00:00:00</div>
                    </div>
                    <div class="bg-slate-800/60 p-3 rounded text-center">
                        <div class="text-slate-400 text-xs mb-1">Toplam Sıra Süresi</div>
                        <div id="stat-total-turn-time" class="font-bold text-white">00:00:00</div>
                    </div>
                </div>
            </div>

            <div id="profile-error" class="text-red-400 text-sm hidden p-3 rounded bg-red-900/30 border border-red-800/50 flex items-start space-x-2">
                <span class="text-lg">⚠️</span>
                <span class="flex-1"></span>
            </div>
            <div id="profile-success" class="text-green-400 text-sm hidden p-3 rounded bg-green-900/30 border border-green-800/50 flex items-start space-x-2">
                <span class="text-lg">✓</span>
                <span class="flex-1"></span>
            </div>
            
            <button type="submit" class="w-full bg-amber-500 hover:bg-amber-600 text-slate-900 font-bold py-3 rounded-lg shadow-lg transition-transform transform hover:scale-105">
                Kaydet ve Devam Et
            </button>
        </form>
    </div>

    <!-- Main Menu Screen -->
    <div id="main-menu-screen" class="w-full max-w-md mx-auto bg-slate-900/70 p-6 rounded-lg shadow-2xl hidden">
        <div id="user-welcome" class="text-center text-xl mb-6 text-slate-300"></div>
        <div class="space-y-4">
            <button id="practice-mode-button" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg shadow-lg transition-transform transform hover:scale-105">🎯 Serbest Antrenman</button>
            <button id="create-game-button" class="w-full bg-amber-500 hover:bg-amber-600 text-slate-900 font-bold py-3 rounded-lg shadow-lg transition-transform transform hover:scale-105">Oyun Kur</button>
            <div class="flex space-x-2">
                <input type="text" id="join-game-input" placeholder="Oda Kodu" class="flex-grow p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500 uppercase">
                <button id="join-game-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105">Katıl</button>
            </div>
            <button id="profile-settings-button" class="w-full bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 rounded-lg">⚙️ Profil Ayarları</button>
            <button id="logout-button" class="w-full bg-slate-600 hover:bg-slate-700 text-white font-bold py-2 rounded-lg mt-4">Çıkış Yap</button>
        </div>
    </div>

    <!-- Lobby Screen -->
    <div id="lobby-screen" class="w-full max-w-md mx-auto bg-slate-900/70 p-6 rounded-lg shadow-2xl hidden">
        <h2 class="text-2xl font-bold text-center mb-4 text-amber-300">Lobi</h2>
        <div class="text-center mb-4">
            <p class="text-slate-400">Oda Kodu:</p>
            <p id="lobby-game-code" class="text-4xl font-bold text-amber-300 tracking-widest"></p>
        </div>
        <div id="lobby-player-list" class="space-y-2 mb-4"></div>
        <div class="space-y-3">
            <button id="ready-button" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg shadow-lg">Hazır</button>
            <button id="start-game-from-lobby-button" class="w-full bg-amber-500 hover:bg-amber-600 text-slate-900 font-bold py-3 rounded-lg shadow-lg hidden">Oyunu Başlat</button>
            <button id="leave-lobby-button" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 rounded-lg mt-2">Lobiden Ayrıl</button>
        </div>
    </div>

    <!-- Main Game Screen -->
    <div id="main-game-screen" class="w-full max-w-7xl mx-auto hidden">
        <h1 class="text-3xl sm:text-4xl font-bold text-center mb-4 text-shadow text-amber-300">Para Maçı</h1>
        <div class="flex flex-col lg:flex-row gap-6">
            <div id="game-container" class="w-full lg:flex-1 aspect-[3/5] rounded-lg relative overflow-hidden bg-slate-900 shadow-inner">
                <canvas id="gameCanvas"></canvas>
                <canvas id="fireworksCanvas" class="absolute inset-0 pointer-events-none"></canvas>
                <div id="game-overlay" class="absolute inset-0 bg-gradient-to-br from-slate-900/95 via-purple-900/90 to-slate-900/95 backdrop-blur-sm flex items-center justify-center hidden text-center rounded-lg p-4">
                    <div class="flex flex-col items-center max-w-lg w-full my-auto">
                        <!-- Animation Container for Fouls/Goals -->
                        <div id="overlay-animation" class="mb-6"></div>
                        
                        <div id="overlay-text" class="text-2xl md:text-4xl font-bold text-white text-shadow leading-tight mb-6"></div>
                        
                        <!-- Player Ready Status Cards -->
                        <div id="rematch-status-container" class="hidden w-full space-y-3 mb-6">
                            <!-- Player status cards will be dynamically added here -->
                        </div>
                        
                        <!-- Action Buttons -->
                        <button id="ack-button" class="hidden bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-3 px-10 rounded-xl shadow-2xl transition-all duration-300 transform hover:scale-110 hover:shadow-blue-500/50 mt-4">
                            <span class="flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Tamam
                            </span>
                        </button>
                        
                        <button id="rematch-button" class="hidden bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-4 px-12 rounded-xl shadow-2xl transition-all duration-300 transform hover:scale-110 hover:shadow-green-500/50 animate-pulse">
                            <span class="flex items-center gap-3 text-lg">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                                Hazırım! 🎮
                            </span>
                        </button>
                        
                        <button id="practice-menu-button" class="hidden bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white font-bold py-3 px-10 rounded-xl shadow-2xl transition-all duration-300 transform hover:scale-105 mt-4">
                            <span class="flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                                </svg>
                                Ana Menüye Dön
                            </span>
                        </button>
                        
                        <div id="waiting-text" class="hidden mt-6 px-6 py-4 bg-amber-500/20 border-2 border-amber-400 rounded-xl backdrop-blur-sm">
                            <div class="flex items-center gap-3">
                                <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-amber-400"></div>
                                <span class="text-lg text-amber-300 font-semibold">Diğer oyuncular bekleniyor...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="w-full lg:w-80 space-y-4">
                <!-- Scoreboard -->
                <div id="scoreboard" class="bg-slate-900/50 p-4 rounded-lg">
                    <h2 class="text-2xl font-bold text-amber-300 border-b-2 border-slate-600 pb-2 mb-2">Oyuncu Durumu</h2>
                    
                    <!-- Game Timer -->
                    <div class="mb-3 text-center">
                        <div class="text-slate-400 text-xs mb-1">⏱️ Toplam Süre</div>
                        <div id="game-timer" class="text-amber-300 font-bold text-lg">00:00:00</div>
                    </div>
                    
                    <div id="player-list" class="space-y-3"></div>
                </div>
                
                <!-- Chat Box -->
                <div id="chat-box" class="bg-slate-900/50 rounded-lg overflow-hidden flex flex-col" style="height: 300px;">
                    <div class="bg-slate-800 p-3 border-b border-slate-700">
                        <h3 class="text-lg font-bold text-amber-300 flex items-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                            </svg>
                            Sohbet
                            <span id="chat-notification-badge" class="hidden bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full animate-pulse"></span>
                        </h3>
                    </div>
                    <div id="chat-messages" class="flex-1 overflow-y-auto p-3 space-y-2 scroll-smooth">
                        <!-- Messages will appear here -->
                    </div>
                    <div class="p-3 border-t border-slate-700">
                        <form id="chat-form" class="flex gap-2">
                            <input 
                                type="text" 
                                id="chat-input" 
                                placeholder="Mesaj yaz..." 
                                maxlength="200"
                                class="flex-1 p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-amber-500 text-sm"
                            >
                            <button 
                                type="submit" 
                                class="bg-amber-500 hover:bg-amber-600 text-slate-900 font-bold px-4 py-2 rounded transition-colors flex items-center justify-center"
                                title="Gönder"
                            >
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path>
                                </svg>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="./firebase-config.js"></script>
    
    <!-- Basic runtime checks to surface clear errors before app init -->
    <script>
        (function () {
            function showFatalError(message) {
                try {
                    var el = document.createElement('div');
                    el.id = 'fatal-error-banner';
                    el.style.position = 'fixed';
                    el.style.inset = '0';
                    el.style.background = 'rgba(15,23,42,0.96)';
                    el.style.color = 'white';
                    el.style.display = 'flex';
                    el.style.alignItems = 'center';
                    el.style.justifyContent = 'center';
                    el.style.zIndex = '9999';
                    el.style.padding = '24px';
                    el.innerHTML = '<div style="max-width:700px;text-align:center;font-family:system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial;">\
                        <h2 style="font-size:28px;margin-bottom:12px;color:#fbbf24;">Uygulama Başlatılamadı</h2>\
                        <p style="font-size:16px;line-height:1.6;margin-bottom:16px;">' + message + '</p>\
                        <div style="opacity:0.8;font-size:14px;">İpucu: İnternet bağlantınızı ve kurumsal ağ/antivirüs engellemelerini kontrol edin. Gerekirse yerel sunucu ile çalıştırın.</div>\
                    </div>';
                    document.body.appendChild(el);
                } catch (e) {
                    alert(message);
                }
            }

            // If completely offline
            if (typeof navigator !== 'undefined' && navigator && navigator.onLine === false) {
                window.SKIP_APP_INIT = true;
                showFatalError('İnternet bağlantısı yok. CDN bağımlılıkları (Tailwind, Firebase SDK) yüklenemedi. Bağlantıyı açıp sayfayı yenileyin veya yerel sunucu kullanın.');
                return;
            }

            // Firebase SDK load check
            if (typeof window.firebase === 'undefined' ||
                typeof window.firebase.auth === 'undefined' ||
                typeof window.firebase.database === 'undefined') {
                // Give the browser a brief moment in case of slow networks
                setTimeout(function(){
                    if (typeof window.firebase === 'undefined' ||
                        typeof window.firebase.auth === 'undefined' ||
                        typeof window.firebase.database === 'undefined') {
                        window.SKIP_APP_INIT = true;
                        showFatalError('Firebase SDK yüklenemedi (ERR_EMPTY_RESPONSE olabilir). Ağınız cdn.gstatic.com erişimini engelliyor olabilir. Alternatif: Firebase Emulators ile veya başka bir ağda deneyin.');
                    }
                }, 300);
            }

            // Config presence check (firebase-config.js)
            if (typeof window.firebase !== 'undefined' && typeof window.firebase.apps !== 'undefined') {
                try {
                    // If no app initialized, initializeApp may have failed
                    if (!window.firebase.apps.length) {
                        // Let main.js handle auth/database access errors gracefully
                        console.warn('Firebase app is not initialized yet. Check firebase-config.js values.');
                    }
                } catch (e) {
                    console.warn('Firebase app state could not be verified:', e);
                }
            }
        })();
    </script>
    <script src="./js/main.js?v=20251027"></script>
</body>
</html>
